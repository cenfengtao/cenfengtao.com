<!DOCTYPE html>
<!--headTrap<body></body><head></head><html></html>-->
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title>优培圈</title>
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/css/home/common.css"/>
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/css/home/com.css"/>
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/css/home/checkOrderInformation.css"/>
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/css/home/pageloader.css"/>
    <!--<script src="js/jquery.min.js" type="text/javascript" charset="utf-8"></script>-->
    <script type="text/javascript">
        if(/msie/i.test(navigator.userAgent)){window.location.href="http://www.youpei-exc.com/"}
    </script>

</head>
<style>
    body, html{
        background:none;
    }
    form{
        margin-top: 2rem;
    }
    form label{
        height: 1.5rem;
    }
    form .name{
        border-bottom:none;
    }
    form .tel{
        border-bottom:none;
    }
    .address{
         margin-top: 0;
        line-height: 1.5rem;
    }
</style>
<body class="kap-loading ty-view-all">
<include file="Common:common"/>
<header class="header">
    <a href="javascript:history.back()" class="back">
        <img src="/Public/images/back.png" alt="">
    </a>
    <h3>填写收货信息</h3>
    <a href="/index.php/Index/index.html" class="home" data-icon="Ņ"></a>
</header>
<article class="middle">
    <form action="">
        <label class="name">
            <span>*联系人：</span>
            <input type="text" placeholder="姓名" name="name">
        </label>
        <label class="tel">
            <span>*电话号码：</span>
            <input type="tel" placeholder="电话" maxlength="11" onchange="testTel(this.value)" name="mobile">
        </label>
        <label class="address">
            <span>*所在地区：</span>
            <select class="province" name="province">
                <option value="请选择省">省份</option>
            </select>
            <select class="city" name="city">
                <option value="请选择市">市</option>
            </select>
            <select class="county" name="county">
                <option value="请选择区">县/区</option>
            </select>
        </label>
        <label class="address">
            <span>*详细地址：</span>
            <input type="text" name="address">
        </label>
        <label class="details">
            <span>留言：</span>
            <textarea name="remark" id="remark"></textarea>
        </label>
    </form>
    <section class="nextStep">
        <a href="javascript:confirmOrder()">提交信息</a>
    </section>
</article>
<footer class="footer">
    <input type="hidden" name="class-key">
    <input type="hidden" name="class-now-price">
    <input type="hidden" name="coupon-ids">
</footer>
<script src="__PUBLIC__/Home/js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
<script src="/Public/js/layer/layer.js"></script>
<script src="__PUBLIC__/Home/js/pageloader.js" type="text/javascript" charset="utf-8"></script>
<script src="__PUBLIC__/js/home/rem.js" type="text/javascript" charset="utf-8"></script>
<script src="__PUBLIC__/js/home/city.js" type="text/javascript" charset="utf-8"></script>
<script src="/Public/js/layer/mobile/layer.js"></script>
<script>
    function confirmOrder() {
        var name = $('input[name="name"]').val();
        var mobile = $('input[name="mobile"]').val();
        var province = $('select[name="province"] option:selected').text();
        var city = $('select[name="city"] option:selected').text();
        var area = $('select[name="county"] option:selected').text();
        var address = $('input[name="address"]').val();
        var message = $('#remark').val();
        if (name == '') {
            alert('填写联系人姓名');
            return;
        }
        if (mobile == '') {
            alert('填写联系人电话');
            return;
        }
        if (!/^1(3|4|5|7|8){1}\d{9}$/.test(mobile)) {
            alert("手机号码格式不正确，请重新填写");
            return;
        }
        if (province == "省份") {
            alert("请选择省份。")
            return
        }
        if (city == "市") {
            alert("请选择市。")
            return
        }
        if (area == "县/区") {
            alert("请选择县/区。")
            return
        }
        if (address == "") {
            alert("请填写详细地址。");
            return
        }
        var url = "/index.php/Company/votePrizeIndex";
        var data = {
            prize_id : getQueryString('prize_id'),
            name: name,
            mobile: mobile,
            province: province,
            city:city,
            area:area,
            address:address,
            message: message
        };
        $.post(url, data, function (result) {
            if (result.status == 0) {
                return alert(result.message);
            } else {
                alert(result.message)
                setTimeout(function () {
                    window.location.href = '/index.php/';
                },2500);
            }
        }, 'json');
    }

    function getQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) return unescape(r[2]);
        return null;
    }

    //城市级联的实现
    $(function () {
        $.getScript("../../../../Public/js/home/city.js", function (data) {
            var result = JSON.parse(data);
            var cityArr = [];
            var countyArr = [];
            for (var i = 0; i < result.length; i++) {
                if (result[i].ProSort) {
                    $(".province").append("<option value='" + result[i].ProID + "'>" + result[i].name + "</option>")//把数据拼接到.province下的option里
                } else if (result[i].CitySort) {
                    cityArr.push(result[i]);//把符合的数据放入cityArr里
                } else if (result[i].DisSort == null) {
                    countyArr.push(result[i]);//把符合的数据放入countyArr里
                }
            }
            $(".province").change(function () {
                var value = $(this).val();
                $(".city option").remove();
                $(".province option").eq(0).remove();
                for (var i = 0; i < cityArr.length; i++) {
                    if (cityArr[i].ProID == value) {
                        $(".city").append("<option value='" + cityArr[i].CityID + "'>" + cityArr[i].name + "</option>"); //把数据拼接到.city下的option里
                    }
                }

                var value2 = $(".city option").val();

                $(".county option").remove();
                for (var i = 0; i < countyArr.length; i++) {
                    if (countyArr[i].CityID == value2)
                        $(".county").append("<option>" + countyArr[i].DisName + "</option>")
                }
            });
            $(".city").change(function () {
                var value = $(this).val();
                $(".county option").remove();
                for (var i = 0; i < countyArr.length; i++) {
                    if (countyArr[i].CityID == value)
                        $(".county").append("<option>" + countyArr[i].DisName + "</option>")//把数据拼接到.county下的option里
                }
            })
        })
    });
</script>
</body>
</html>
<!--tailTrap<body></body><head></head><html></html>-->