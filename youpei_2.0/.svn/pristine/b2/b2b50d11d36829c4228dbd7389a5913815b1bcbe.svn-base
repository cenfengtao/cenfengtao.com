<include file="Common:header"/>
<style type="text/css">
/**未出UI css暂时写在这*/
html {
  height: 100%;
  -webkit-text-size-adjust: none;
}
body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  min-height: 100%;
 font-family: "Microsoft YaHei","微软雅黑",Arial;
  /*font-family: Microsoft YaHei,Arial,san-serif;*/
  -webkit-touch-callout: none;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  position: relative;
  font-size: 14px;
  overflow-x: hidden;
}
input[type="text"]{
	-webkit-appearance: none;outline: none;
}
input:disabled, input[disabled]{ color: #156799; -webkit-text-fill-color:#156799; -webkit-opacity:1; opacity: 1; }
.redlist{
	text-align: center;
}

.redchange .increase, .redchange .reduce {
	display: inline-block;
	width: 40px;
	height: 40px;
	vertical-align: 5px;
}
.number {
	margin-left: 15px;
	margin-right: 15px;
}
.redchange .number .counts{
	border: 1px solid #85b6d4;
	display: inline-block;
	width: 37px;
	height: 37px;
	border-radius: 4px;
	background: #b8d5e7;
	line-height: 28px;
	text-align: center;
	color: #156799;
	text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
	box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3) inset;
	font-size: 22px;
}
.redchange .ico-increase, .redchange .ico-reduce {
	position: relative;
	display: block;
	width: 30px;
	height: 30px;
	margin: 6px 0 0 5px;
	background: #D00A0A;
	border-radius: 50%;
	text-indent: -9999px;
}
.redchange .ico-reduce {
	background: #1a669a;
}

.redchange .ico-increase:after, .redchange .ico-reduce:after {
	position: absolute;
	top: 14px;
	left: 7px;
	content: "";
	display: block;
	width: 15px;
	height: 3px;
	background: #FFFFFF;
}
.redchange .ico-increase:before {
	position: absolute;
	top: 8px;
	left: 13px;
	content: "";
	display: block;
	width: 3px;
	height: 15px;
	background: #FFFFFF;
}
dt span{
	color: #156799;
	font-weight:bold;
	font-size: 28px;
}
.redlist dt{
	margin-top: 10px;
	margin-bottom:10px;
}
.integral{
	width: 30%;
	height: 25px;
		background-color: #b7d5e6;
	color: #156799;
	border-radius:5px;
	text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}
input.integral{text-align:center;}
.footerbtn {
    margin:20px auto;
  /*  width: 50%;*/
}
.submit {
	background-color: #ef3f56;
	padding: 6px 20px;
	font-size: 1rem;
	letter-spacing: 2px;
	text-decoration: none;
	border: 1px solid #c03143;
	border-radius: 5px;
	color: #ffffff;
	display: block;
	cursor: pointer;
	text-align: center;
	font-weight:bold;
	width:50%;
	margin-left: 25%;
}

.submit:active {
	background-color: #B60006;
}
.foot{
	color:#000000;
 position:absolute;
bottom:0px;
padding:0px;
margin:0px -100px;
}

</style>
<body>
<section class="red">
     <div class="redlist">
      <input type="hidden" name="integral_exchange" id="integral_exchange" value="{$integral_exchange}">
     <ul>
	     <dt><span>可用积分</span></dt>
	     <li><input type="text" id="integral"  name="integral" class="integral" disabled="true"　readOnly="true" value="{$integral}" style="border:0;"></li>
	     <dt><span>请选择兑换抽奖次数</span></dt>
          <li>
             <div class="redchange">
			    <a class="reduce" href="javascript:void(0)" onclick="reduceProductN()">
				<b class="ico-reduce">减一份</b></a><span id="num" class="number"><input value="0" disabled="true" type="text" name="" id="count" class="counts"></span><a class="increase" href="javascript:void(0)" onclick="addProductN()"><b class="ico-increase">加一份</b></a>
					</div>
          </li>
	     </ul>	
	     <div class="twobtn">
		   <div class="footerbtn">
			<a class="submit left3" onclick="submitintegral()">确认兑换</a>
				</div>
						<div class="clr"></div>
					</div>
		 <p style="color:black;text-align: left;text-indent: 7vh;"><span style="color:red">*</span>每日签到，分享文章均可获得积分</p>
		<p style="color:black;text-align: left;text-indent: 7vh;"><span style="color:red">*</span>{$integral_exchange}积分兑换一次抽奖机会</p>
	</div>
</section>
<script type="text/javascript">
function addProductN(){
var num=parseFloat($('.counts').val());
var n=parseFloat($('#integral').val());
var integral_exchange=parseFloat($('#integral_exchange').val());
var nums=parseInt(num)+1;
var integral=parseInt(n)-parseInt(integral_exchange);

if (integral <0 ) {return;}
if(nums<1 || nums>100){ return;}
$('.counts').val(nums);
 $('#integral').val(integral);  
}
function reduceProductN(){
var num=parseFloat($('.counts').val());
var n=parseFloat($('#integral').val());
var integral_exchange=parseFloat($('#integral_exchange').val());
var nums=parseInt(num)-1;
var integral=parseInt(n)+parseInt(integral_exchange);;  
if (integral <n ) {return;}
	if(nums<1){ return;}
	$('.counts').val(nums);
	$('#integral').val(integral); 
}
function submitintegral(id){
    var num=$('#count').val();
    if (num>=1) {
	$.post("{:U('Lottery/confirmexchange')}",{num:num},function(res){
			if(res.status==1){
				alert('兑换成功');
				setTimeout(function () {
					window.parent.location.reload();
					var index = parent.layer.getFrameIndex(window.name);
					parent.layer.close(index);
				}, 1000);
			}else if(res.status==2){
				layer.open({
					   content: res.msg
					   ,btn: '我知道了'
					});
			}else{
				alert(res.msg||'兑换失败');
				window.location.href=window.location.href+"?math="+10000*Math.random();
			}
        })
	}else{
		alert('兑换不能小于0');
	}
}

</script>
<include file="Common:footer"/>

</body>
</html>