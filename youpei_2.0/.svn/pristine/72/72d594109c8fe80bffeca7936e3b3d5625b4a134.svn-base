<include file="Common:header"/>
<!-- NProgress -->
<link href="__PUBLIC__/vendors/nprogress/nprogress.css" rel="stylesheet">
<!-- iCheck -->
<link href="__PUBLIC__/vendors/iCheck/skins/flat/green.css" rel="stylesheet">
<!-- SELF -->
<link rel="stylesheet" href="__PUBLIC__/css/admin/main.css">
<link rel="stylesheet" href="__PUBLIC__/css/admin/index.css">
<style>
    canvas {
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select: none;
    }
    .center_header{
        text-align:center;
        font-size: 19px;
    }
</style>
<body class="nav-md">
<div class="container body">
    <div class="main_container">
        <include file="Common:menu"/>
        <!-- page content -->
        <if condition="$isSuper eq 2">
            <div class="right_col" role="main" style="padding-bottom: 1px;">
                <div style="text-align: center;margin-top: 110px;">
                    <h1>欢迎登陆优培圈后台</h1>
                </div>
            </div>
            <else/>
            <div class="right_col" role="main" style="padding-bottom: 1px;">
                <div class="center_header">
                    30天内用户登录和增加记录
                </div>
                <div class="col_chart">
                    <div style="width:100%;">
                        <canvas id="canvas" style="width:80%;height:500px;"></canvas>
                    </div>
                </div>
                <div class="center_header">
                    半年内用户登录和增加记录
                </div>
                <div class="col_chart">
                    <div style="width:100%;">
                        <canvas id="year" style="width:80%;height:500px;"></canvas>
                    </div>
                </div>
            </div>
        </if>
        <!-- /page content -->
        <!-- footer content -->
        <footer>
            <div class="pull-right">
                2017 © 优培圈
            </div>
            <!-- 获取权限 -->
            <div style="display: none">
                <foreach name="accessIdList" key="k" item="val">
                    <p class="accessIdList" attr_key="{$k}" attr_value="{$val}"></p>
                </foreach>
            </div>
            <div class="clearfix"></div>
        </footer>
        <!-- jQuery -->
        <script src="__PUBLIC__/vendors/jquery/dist/jquery.min.js"></script>
        <!-- Bootstrap -->
        <script src="__PUBLIC__/vendors/bootstrap/dist/js/bootstrap.min.js"></script>
        <!-- FastClick -->
        <script src="__PUBLIC__/vendors/fastclick/lib/fastclick.js"></script>
        <!-- bootstrap-progressbar -->
        <script src="__PUBLIC__/vendors/bootstrap-progressbar/bootstrap-progressbar.min.js"></script>
        <!-- Skycons -->
        <script src="__PUBLIC__/vendors/skycons/skycons.js"></script>
        <!-- Custom Theme Scripts -->
        <script src="__PUBLIC__/js/custom/custom.min-index.js"></script>
        <!-- NProgress -->
        <script src="__PUBLIC__/vendors/nprogress/nprogress.js"></script>
        <!-- layer -->
        <script src="__PUBLIC__/js/layer/layer.js"></script>
        <script src="__PUBLIC__/js/dialog.js"></script>
        <!-- common -->
        <script src="__PUBLIC__/js/admin/common.js"></script>
        <!-- /footer content -->
    </div>
</div>
<!-- FastClick -->
<script src="__PUBLIC__/vendors/fastclick/lib/fastclick.js"></script>

<!-- chart.js -->
<script src="__PUBLIC__/js/Chart.js-2.6.0/dist/Chart.bundle.js"></script>
<script src="__PUBLIC__/js/Chart.js-2.6.0/samples/utils.js"></script>
<script>
    var dates = new Array();
    var new_user = new Array();
    var login_user = new Array();
    var datesData = {$monthData};
    var i = 0;
    $.each(datesData, function (index, item) {
        dates[i] = item['date'];
        new_user[i] = item['new_user'];
        login_user[i] = item['login_user'];
        i++;
    });
    var config = {
        type: 'line',
        data: {
            labels: dates,
            datasets: [{
                label: "用户增加数量",
                backgroundColor: window.chartColors.red,
                borderColor: window.chartColors.red,
                data: new_user,
                fill: false,
            }, {
                label: "每日登陆数量",
                backgroundColor: window.chartColors.green,
                borderColor: window.chartColors.green,
                data: login_user,
                fill: false,
            }]
        },
        options: {
            responsive: true,
            title: {
                display: true,
            },
            tooltips: {
                mode: 'index',
                intersect: false,
            },
            hover: {
                mode: 'nearest',
                intersect: true
            },
            scales: {
                xAxes: [{
                    display: true,
                    scaleLabel: {
                        display: true,
                    }
                }],
                yAxes: [{
                    display: true,
                    scaleLabel: {
                        display: true,
                    },
                    ticks: {
                        min: 0,
                        max: 500,
                        stepSize: 20
                    }
                }]
            }
        }
    };
    var date_year = new Array();
    var user_year = new Array();
    var login_year = new Array();
    var yearData = {$yearData};
    var l = 0;
    $.each(yearData, function (index, item) {
        date_year[l] = item['date'];
        user_year[l] = item['new_user'];
        login_year[l] = item['login_user'];
        l++;
    });
    var config_year = {
        type: 'line',
        data: {
            labels: date_year,
            datasets: [{
                label: "用户增加数量",
                backgroundColor: window.chartColors.red,
                borderColor: window.chartColors.red,
                data: user_year,
                fill: false,
            }, {
                label: "每日登陆数量",
                backgroundColor: window.chartColors.green,
                borderColor: window.chartColors.green,
                data: login_year,
                fill: false,
            }]
        },
        options: {
            responsive: true,
            title: {
                display: true,
            },
            tooltips: {
                mode: 'index',
                intersect: false,
            },
            hover: {
                mode: 'nearest',
                intersect: true
            },
            scales: {
                xAxes: [{
                    display: true,
                    scaleLabel: {
                        display: true,
                    }
                }],
                yAxes: [{
                    display: true,
                    scaleLabel: {
                        display: true,
                    },
                    ticks: {
                        min: 0,
                        max: 500,
                        stepSize: 50
                    }
                }]
            }
        }
    };
    window.onload = function () {
        var ctx = document.getElementById("canvas").getContext("2d");
        window.myLine = new Chart(ctx, config);
        var year = document.getElementById("year").getContext("2d");
        window.myLine = new Chart(year, config_year);
    };
</script>
</body>
</html>
