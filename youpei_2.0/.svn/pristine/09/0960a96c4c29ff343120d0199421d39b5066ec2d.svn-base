 $(".footer ul li>img").css("display","none");
$(".footer ul li>img:eq(2)").css("display","block");
$(" .footer ul li").click(function(){
    $(this).addClass('on').siblings().removeClass("on");
    var index=$(this).index();
    var liLen=$(".footer ul li").length;
    for(var i=0;i<=liLen-1;i++){
        $(".footer ul li>img").eq(i).css("display","none");
    }
    $(this).find("img:eq(0)").css("display","block");
})




//    获取url参数
function GetRequest() {
    var url = location.search; //获取url中"?"符后的字串
    var theRequest = new Object();
    if (url.indexOf("?") != -1) {
        var str = url.substr(1);
        strs = str.split("&");
        for (var i = 0; i < strs.length; i++) {
            theRequest[strs[i].split("=")[0]] = unescape(strs[i].split("=")[1]);
        }
    }
    return theRequest;
}
var vote_id=GetRequest().vote_id;
    $.ajax({
        type:"post",
        url:"/index.php/Vote/ajaxUserWorks",
        async: true,
        dataType:"json",
        data:{

        },
        success:function(data){
            if(data.status==1){
                var data=data.data;
                var dataLength=data.length;
                for(var i=0; i<dataLength; i++){
                    if(data[i].upload_type==1){
                        var year=data[i].time.split("-")[0];
                        var month=data[i].time.split("-")[1];
                        var day=data[i].time.split("-")[2];
                        $(".works").append(
                            '<li onclick="toVote('+data[i].id+','+data[i].vote_id+')" class="to">'+
                                '<section class="date">'+
                                    '<p>投稿日期：<span>'+year+'年'+month+'月'+day+'日</span></p>'+
                                    '<span class="status"></span>'+
                                '</section>'+
                                '<section class="img">'+
                                    '<img src="'+data[i].path+'" alt="">'+
                                '</section>'+
                                '<section class="name">'+
                                    '<p><i></i>名称：<span>'+data[i].title+'</span></p>'+
                                '</section>'+
                                '<section class="nowTicket">'+
                                    '<p><i></i>当前票数：<span>'+data[i].vote_count+'</span>票</p>'+
                                '</section>'+
                                '<section class="go">'+
                                    '<a href="javascript:void(0)" class="goVote">去拉票</a>'+
                                    '<a href="###" onclick="revise(event,'+data[i].id+','+data[i].vote_id+')" class="revise">我要修改</a>'+
                                '</section>'+
                            '</li>'
                        )
                        if(data[i].voteStatus==1){
                            $(".go").eq(i).html('<a href="javascript:void(0)" onclick="alerts(event)" class="goVote" style="background:gray;">去拉票</a>');
                        }
                        if(data[i].voteStatus==2){
                            if(data[i].status==1){
                                document.getElementsByClassName("status")[i].innerHTML="审核中，请耐心等待";
                                document.getElementsByClassName("goVote")[i].style.display="none";
                                document.getElementsByClassName("revise")[i].style.marginTop="0";
                                document.getElementsByClassName("to")[i].onclick=function(){};
                            }
                            if(data[i].status==3){
                                document.getElementsByClassName("status")[i].innerHTML="落选了，请重新投稿";
                                document.getElementsByClassName("goVote")[i].style.display="none";
                                document.getElementsByClassName("revise")[i].style.marginTop="0";
                                document.getElementsByClassName("to")[i].onclick=function(){};
                            }
                        }
                    }
                    if(data[i].upload_type==2){
                        var year=data[i].time.split("-")[0];
                        var month=data[i].time.split("-")[1];
                        var day=data[i].time.split("-")[2];
                        $(".works").append(
                            '<li onclick="toVote('+data[i].id+','+data[i].vote_id+')" class="to">'+
                                '<section class="date">'+
                                    '<p>投稿日期：<span>'+year+'年'+month+'月'+day+'日</span></p>'+
                                    '<span class="status"></span>'+
                                '</section>'+
                                '<section class="img">'+
                                    '<video src="'+data[i].path+'" autoplay></video>'+
                                '</section>'+
                                '<section class="name">'+
                                    '<p><i></i>名称：<span>'+data[i].title+'</span></p>'+
                                '</section>'+
                                '<section class="nowTicket">'+
                                    '<p><i></i>当前票数：<span>'+data[i].vote_count+'</span>票</p>'+
                                '</section>'+
                                '<section class="go">'+
                                    '<a href="javascript:void(0)" class="goVote">去拉票</a>'+
                                    '<a href="###" onclick="revise(event,'+data[i].id+','+data[i].vote_id+')" class="revise">我要修改</a>'+
                                '</section>'+
                            '</li>'
                        )
                       if(data[i].voteStatus==1){
                            document.getElementsByClassName("go")[i].style.display="none";
                        }
                        if(data[i].voteStatus==2){
                            if(data[i].status==1){
                                document.getElementsByClassName("status")[i].innerHTML="审核中，请耐心等待";
                                document.getElementsByClassName("goVote")[i].style.display="none";
                                document.getElementsByClassName("revise")[i].style.marginTop="0";
                                document.getElementsByClassName("to")[i].onclick=function(){};
                            }
                            if(data[i].status==3){
                                document.getElementsByClassName("status")[i].innerHTML="落选了，请重新投稿";
                                document.getElementsByClassName("goVote")[i].style.display="none";
                                document.getElementsByClassName("revise")[i].style.marginTop="0";
                                document.getElementsByClassName("to")[i].onclick=function(){};
                            }
                        }
                    }
                }
            
            } 
        }
    })
    function toVote(id,vote_id){
        window.location.href="/index.php/Vote/voteDetail.html?id="+id+"&vote_id="+vote_id;
    }
      function stopBubble(e)
    {
        if (e && e.stopPropagation)
            e.stopPropagation()
        else
            window.event.cancelBubble=true
    }         

     function revise(event,id,vote_id){
        stopBubble()
        event.preventDefault();
        if ($(event.target).is('.revise')) {
           window.location.href="/index.php/Vote/contribution.html?id="+id+"&vote_id="+vote_id;
        }
        
    }
    function alerts(event){
        stopBubble()
        alert("该作品的投票活动已结束，点击图片可查看该作品之前的投票详情。")
    }