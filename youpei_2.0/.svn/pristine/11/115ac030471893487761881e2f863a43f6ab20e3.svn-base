<!DOCTYPE html>
<!--headTrap<body></body><head></head><html></html>-->
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title>优培圈</title>
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/css/home/common.css"/>
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/css/home/com.css"/>
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/css/home/pageloader.css"/>
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/css/home/swiper.min.css"/>
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/css/homes/voteActivityList.css"/>
    <style>
        .roll{
            background: white;
            margin-bottom: 0.02rem;
        }
        .roll >h3{
            font-size: 0.2669rem;
            color: #959696;
            font-weight: normal;
            text-align: center;
            height: 1.12rem;
            line-height: 1.12rem;
        }
        .roll >h3 strong{
            font-size: 0.468rem;
            color: #386998;
            font-weight: normal;
        }
        .rollList{
            overflow: hidden;
            height: 1.2rem;
            line-height: 1.2rem;
            background: white;
            margin-bottom: 0.2rem;
        }
        .rollList img{
            width: 0.52rem;
            height: 0.51rem;
            float: left;
            margin: 0.3rem 0.25rem 0 0.37rem;
        }
        .rollList ul{
            float: left;
            width: 10.13rem;
        }
        .rollList ul li{
            font-size: 0.4rem;
        }
        .people{
            margin-bottom: 0.06rem;
        }
        .people ul{
            overflow: hidden;
        }
        .orgLists ul li{
            display: flex;
            flex-flow: row;
            background: white;
            height: 4.33rem;
            margin-bottom: 0.15rem;
        }
        .orgLists .img{
            width: 4.12rem;
            height: 3.37rem;
            position: relative;
            margin: 0.47rem 0.16rem 0 0.36rem;

        }
        .orgLists .img img{
            width: 100%;
            height: 100%;
        }
        .orgLists .img .type{
            height: 0.6rem;
            line-height: 0.6rem;
            background: rgba(0,0,0,0.3);
            width: 100%;
            position: absolute;
            bottom: 0;
            left: 0;
        }
        .orgLists .img .type span{
            height: 0.43rem;
            line-height: 0.43rem;
            font-size: 0.2593rem;
            padding: 0 0.1rem;
            color: white;
            display: inline-block;
            margin-right: 0.13rem;
            border-radius: 0.1rem;
        }
        .orgLists .img .type span:first-child{
            background-color: #ffc62d;
            margin-left: 0.23rem;
        }
        .orgLists .img .type span:nth-child(2){
            background-color: #e0656b;
        }
        .orgLists .img .type span:nth-child(3){
            background-color: #62b7e3;
            margin-right: 0;
        }
        .orgLists .text{
            flex: 3;
            margin-top: 0.47rem;
        }
        .orgLists .text h3{
            font-size: 0.42rem;
            line-height: 0.73rem;
            height: 0.73rem;
            color: #386998;
            border-bottom:0.02rem solid #d5d5d5;
            width: 95%;
            padding-left: 0;
        }
        .orgLists .text .work{
            height: 0.86rem;
            line-height: 0.86rem;
            overflow: hidden;
            border-bottom:0.02rem solid #d5d5d5;
            width: 95%;
        }
        .orgLists .text .workNum{
            float: left;
        }
        .orgLists .workNum span{
            font-size: 0.4rem;
        }
        .orgLists .text .workNum strong{
            font-weight: normal;
            color: #386998;
            font-size: 0.4rem;
        }
        .orgLists .text .heat{
            float: left;
            font-size: 0.4rem;
            margin-left: 0.3rem;
        }
        .orgLists .text .heat span{
            font-size: 0.4rem;
            float: left;
            margin-right: 0.1rem;
        }
        .orgLists .text .heat img{
            width: 0.4rem;
            height: 0.38rem;
            display: inline-block;
            margin-top: 0.22rem;
        }
        .orgLists .text .date span{
            font-size: 0.4rem;
            height: 0.86rem;
            line-height: 0.86rem;
        }
        .orgLists .text .date .dateTime{
            color: #386998;
        }
        .orgLists .text>a{
            float: right;
            height: 0.8rem;
            width: 3rem;
            text-align: center;
            line-height: 0.8rem;
            background: #db6066;
            color: white;
            font-size: 0.4rem;
            display: inline-block;
            margin-right: 0.4rem;
            border-radius: 0.1rem;
        }

    </style>
    <script type="text/javascript">
        if(/msie/i.test(navigator.userAgent)){window.location.href="http://www.youpei-exc.com/"}
    </script>
</head>
<body class="kap-loading ty-view-all">
<include file="Common:common"/>
<header class="header">
    <a href="javascript:history.back()" class="back">
        <img src="../../../../Public/images/back.png" alt="">
    </a>
    <h3>活动列表</h3>
    <a href="../Index/index.html" class="home" data-icon="Ņ"></a>
</header>
<article class="middle">
    <section class="advert">
        <img src="../../../../Public/images/vote2.jpg" alt="">
    </section>
    <section class="joinNum">
        <div style="font-size:0.42rem;"><span style="float: left;margin-top: 0.3rem;"></span>《优培圈》品牌比赛活动累计参与人数：<strong class="total" style="font-size: 0.42rem;">0</strong></div>
    </section>
    <section class="roll">
        <h3>——/ <strong>获</strong> / <strong>奖</strong> / <strong>名</strong> / <strong>单</strong> /——</h3>
    </section>
    <section class="rollList">
        <img src="../../../../Public/images/rollSound.png" alt="">
         <div class="swiper-container">
            <ul class="swiper-wrapper">
                <li class="swiper-slide">《优培圈塔建比赛》第一名 优小培 获得冰箱一台! </li>
                <li class="swiper-slide">《优培圈塔建比赛》第一名 优小培 获得冰箱一台! </li>
                <li class="swiper-slide">《优培圈塔建比赛》第一名 优小培 获得冰箱一台! </li>
            </ul>
        </div>    
    </section>
    <section class="people">
        <ul>
            <li class="on">
                <span>火热进行中（<strong class="proceed">0</strong>）</span>
            </li>
            <li>
                <span>已结束（<strong class="over">0</strong>）</span>
            </li>
        </ul>
    </section>
    <section class="orgLists">
        <ul class="proceedList"> 
        </ul>
        <ul class="overList" style="display: none;">
        </ul>
    </section>
</article>
<script src="__PUBLIC__/Home/js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
<script src="__PUBLIC__/Home/js/pageloader.js" type="text/javascript" charset="utf-8"></script>
<script src="__PUBLIC__/js/home/rem.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" src="__PUBLIC__/js/home/swiper.min.js" ></script>
<script src="__PUBLIC__/js/homes/voteActivityList.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" src="__PUBLIC__/Home/js/jweixin-1.0.0.js"></script>
<script>
    var mySwiper = new Swiper('.swiper-container',{
        pagination: '.pagination',
        loop:true,
        grabCursor: true,
        paginationClickable: true,
        centeredSlides: true,
        autoplay: 2000,
        autoplayDisableOnInteraction: false
    });
    $(function(){
        $(".people li").click(function(){
            var index=$(this).index();
            $(this).addClass("on").siblings().removeClass("on")
            $(".orgLists ul").eq(index).show().siblings().hide()
        })
    })
    function GetRequest() {
    var url = location.search; //获取url中"?"符后的字串
    var theRequest = new Object();
    if (url.indexOf("?") != -1) {
        var str = url.substr(1);
        strs = str.split("&");
        for (var i = 0; i < strs.length; i++) {
            theRequest[strs[i].split("=")[0]] = unescape(strs[i].split("=")[1]);
        }
    }
    return theRequest;
}
var vote_id=GetRequest().vote_id;
 // 微信端分享
    $.ajax({
        type: "get",
        url: "/index.php/Vote/voteActivitContribution",
        aysnc: true,
        dataType: "json",
        success:function(data){
            var title="【优培·投票】优培投票活动";
            var f_title="快来参与投票吧！";
            var shareUrl="{$shareData['share_url']}";
            var shareImg=data.data.share_img;
            // 调用微信的分享接口
            wx.config({
                debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
                appId: "{$signPackage['appId']}", // 必填，公众号的唯一标识
                timestamp: "{$signPackage['timestamp']}", // 必填，生成签名的时间戳
                nonceStr: "{$signPackage['nonceStr']}", // 必填，生成签名的随机串
                signature: "{$signPackage['signature']}",// 必填，签名，见附录1
                jsApiList: ['onMenuShareTimeline', 'onMenuShareAppMessage', 'onMenuShareQQ', 'onMenuShareWeibo', 'hideOptionMenu', 'showOptionMenu', 'hideMenuItems', 'showMenuItems', 'hideAllNonBaseMenuItem', 'showAllNonBaseMenuItem', 'closeWindow', 'chooseImage', 'uploadImage', 'getLocation'] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
            });
            wx.ready(function () {
                wx.onMenuShareAppMessage({
                    title: title,
                    desc: f_title,
                    link: shareUrl,
                    imgUrl: shareImg,
                    success: function () {
                        alert('已分享');
                    },
                    cancel: function () {
                        alert('已取消');
                    }
                });
                wx.onMenuShareTimeline({
                    title: title,
                    link: shareUrl,
                    imgUrl: shareImg,
                    success: function () {
                        alert('已分享');
                    },
                    cancel: function () {
                        alert('已取消');// 用户取消分享后执行的回调函数
                    }
                });

            });
        }
    })

$.ajax({
    type: "get",
    url: "/index.php/Vote/ajaxVoteActivityList",
    aysnc: true,
    dataType: "json",
    success:function(data){
        var overCount=data.data.overCount;
        var proceedCount=data.data.proceedCount;
        var voteUserSum=data.data.voteUserSum;
        var overActivity=data.data.over;
        var overLength=overActivity.length;
        var proceedActivity=data.data.proceed;
        var proceedLength=proceedActivity.length;
        $(".over").html(overCount);
        $(".proceed").html(proceedCount);
        $(".total").html(voteUserSum)
        for(var i=0; i<proceedLength; i++){
            var month=proceedActivity[i].vote_end_time.split("/")[1];
            var day=proceedActivity[i].vote_end_time.split("/")[2];
            $(".proceedList").append(
                    '<li onclick="voteList('+proceedActivity[i].id+')">'+
                        '<div class="img">'+
                            '<img src="'+proceedActivity[i].image+'" alt="" class="org">'+
                            '<div class="type">'+
                                '<span>创造力</span>'+
                                '<span>动手</span>'+
                                '<span>美感</span>'+
                            '</div>'+
                        '</div>'+
                        '<div class="text">'+
                            '<h3>'+proceedActivity[i].title+'</h3>'+
                            '<div class="work">'+
                                '<p class="workNum">'+
                                    '<span>参与作品数 : <strong>'+proceedActivity[i].userWorksCount+'</strong></span>'+
                                '</p>'+
                                '<p class="heat num'+i+'">'+
                                '</p>'+
                            '</div>'+
                            '<div class="date">'+
                                '<span>活动时间 : </span>'+
                                '<span class="dateTime">'+proceedActivity[i].work_start_time+'-'+month+'/'+day+'</span>'+
                            '</div>'+
                            '<a href="/index.php/Vote/contribution.html?vote_id='+proceedActivity[i].id+'">立即参加比赛</a>'+
                        '</div>'+
                    '</li>'  
                )
            var num=".num"+i;
            if(proceedActivity[i].userWorksCount>2){
                $(num).html(
                        '<span>热度 : </span>'+
                        '<img src="../../../../Public/images/star.png" alt="">'
                    )
            }
            if(proceedActivity[i].userWorksCount>5){
                $(num).html(
                        '<span>热度 : </span>'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'
                    )
            }
            if(proceedActivity[i].userWorksCount>8){
                $(num).html(
                        '<span>热度 : </span>'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'
                    )
            }
            if(proceedActivity[i].userWorksCount>11){
                $(num).html(
                        '<span>热度 : </span>'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'
                    )
            }
            if(proceedActivity[i].userWorksCount>14){
                $(num).html(
                        '<span>热度 : </span>'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'
                    )
            }
        }

        for(var j=0; j<overLength; j++){
            var month=overActivity[j].vote_end_time.split("/")[1];
            var day=overActivity[j].vote_end_time.split("/")[2];
            $(".overList").append(
                    '<li onclick="voteList('+overActivity[j].id+')">'+
                        '<div class="img">'+
                            '<img src="'+overActivity[j].image+'" alt="" class="org">'+
                            '<div class="type">'+
                                '<span>创造力</span>'+
                                '<span>动手</span>'+
                                '<span>美感</span>'+
                            '</div>'+
                        '</div>'+
                        '<div class="text">'+
                            '<h3>'+overActivity[j].title+'</h3>'+
                            '<div class="work">'+
                                '<p class="workNum">'+
                                    '<span>参与作品数 : <strong>'+overActivity[j].userWorksCount+'</strong></span>'+
                                '</p>'+
                                '<p class="heat number'+j+'">'+
                                    '<span>热度 : </span>'+
                                    '<img src="../../../../Public/images/star.png" alt="">'+
                                    '<img src="../../../../Public/images/star.png" alt="">'+
                                    '<img src="../../../../Public/images/star.png" alt="">'+
                                '</p>'+
                            '</div>'+
                            '<div class="date">'+
                                '<span>活动时间 : </span>'+
                                '<span class="dateTime">'+overActivity[j].work_start_time+'-'+month+'/'+day+'</span>'+
                            '</div>'+
                            '<a href="/index.php/Vote/contribution.html?vote_id='+overActivity[j].id+'">立即参加比赛</a>'+
                        '</div>'+
                    '</li>'  
                )
             var number=".number"+j;
            if(proceedActivity[j].userWorksCount>2){
                $(number).html(
                        '<span>热度 : </span>'+
                        '<img src="../../../../Public/images/star.png" alt="">'
                    )
            }
            if(proceedActivity[j].userWorksCount>5){
                $(number).html(
                        '<span>热度 : </span>'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'
                    )
            }
            if(proceedActivity[j].userWorksCount>8){
                $(number).html(
                        '<span>热度 : </span>'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'
                    )
            }
            if(proceedActivity[j].userWorksCount>11){
                $(number).html(
                        '<span>热度 : </span>'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'
                    )
            }
            if(proceedActivity[j].userWorksCount>14){
                $(number).html(
                        '<span>热度 : </span>'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'+
                        '<img src="../../../../Public/images/star.png" alt="">'
                    )
            }
        }
    }
})

    function voteList(id){
        window.location.href="/index.php/Vote/voteList.html?vote_id="+id;
    }
</script>
</body>
</html>
<!--tailTrap<body></body><head></head><html></html>-->
