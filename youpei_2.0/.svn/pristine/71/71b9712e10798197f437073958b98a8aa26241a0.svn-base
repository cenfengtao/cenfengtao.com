$(function(){
    // 头部导航选项卡功能
    // $(".nav ul li").click(function(){
    //     var index=$(this).index();
    //     $(".nav ul li").eq(index).addClass("on").siblings().removeClass("on");
    //     $(".content>div").eq(index).css("display","block").siblings().css("display","none")
    // })
    // 底部导航选中状态
    $(".footer ul li>img").css("display","none");
    $(".footer ul li>img:eq(2)").css("display","block");
    $(" .footer ul li").click(function(){
        $(this).addClass('on').siblings().removeClass("on");
        var index=$(this).index();
        var liLen=$(".footer ul li").length;
        for(var i=0;i<=liLen-1;i++){
            $(".footer ul li>img").eq(i).css("display","none");
        }
        $(this).find("img:eq(0)").css("display","block");
    })
// 当屏幕发生变化时重新加载页面
    $(window).resize(function(){
        location.reload();
    })
    // 导航左右滑动箭头的改变
    var winW=$(window).width();
    var liLength=$(".type ul li").length;
    var ulList=document.querySelector(".type ul");
    var arrowRight=document.querySelector(".type .right");
    var arrowLeft=document.querySelector(".type .left");
    var get=parseInt((winW-320)*47/80)+parseInt(216);
    var startLeft;
    var moveLeft;
    var endLeft;
    ulList.addEventListener('touchstart',function(){
        startLeft=$(this).scrollLeft();
    })
    ulList.addEventListener('touchmove',function(){
        moveLeft=$(this).scrollLeft();
        if(moveLeft-startLeft>0){
            arrowRight.style.display="none";
            arrowLeft.style.display="block";
            ulList.style.paddingLeft="1.5rem";
        }else if(moveLeft-startLeft<0){
            arrowLeft.style.display="none";
            arrowRight.style.display="block";
        }
    })

})



 $(function(){ 
      // 点击导航分类按钮获取不同的数据并呈现出来  
     $.ajax({
        type:"get",
        url:"/index.php/Association/associationList",
        aysnc:true,
        data:{
            'type_id':2,
            'cate_id':0
        },
        dataType:"json",
        success:function(data){
            // console.log(data)
            // console.log(data.data.cateList)
            var smallNav=$(".smallNav");
            var cate=data.data.cateList;
            for(var i=0;i<=cate.length-1;i++){
                 smallNav.append('<li><a href="###" id="'+cate[i].id+'" class="a">'+cate[i].title+'</a></li>')
            }
            var list=data.data.list;
            var type_list=$(".con");
            // 遍历默认第一个分类数据
            for(var a=0;a<=list.length-1;a++){
                type_list.append('<li>'+
                    '<div class="title">'+list[a].title+'</div>'+
                    '<span>'+
                        '<img src="'+list[a].logo+'" alt="">'+
                    '</span>'+   
                    '<a href="javascript:void(0);" class="code">'+
                        '<img src="'+list[a].pic_url+'"/>'+
                    '</a>'+
                    '<div class="join">'+
                        '<span>89人进群</span>'+
                        '<a href="javascript:void(0);#">加入</a>'+
                    '</div>'+
                    '<div class="tan">'+
                        '<div class="attention">'+
                            '<img src="'+list[a].qr_code+'"/>'+
                            '<span>长按二维码可关注哦</span>'+
                        '</div>'+    
                     '</div>'+
                '</li>')
            }
            // 点击遍历默认第一个分类数据
            $(".first").click(function(){
                for(var s=0;s<=list.length-1;s++){
                    type_list.append('<li>'+
                        '<div class="title">'+list[s].title+'</div>'+
                        '<span>'+
                            '<img src="'+list[s].logo+'" alt="">'+
                        '</span>'+
                        '<a href="javascript:void(0);" class="code">'+
                            '<img src="'+list[s].pic_url+'"/>'+
                        '</a>'+
                        '<div class="join">'+
                            '<span>89人进群</span>'+
                            '<a href="javascript:void(0);">加入</a>'+
                        '</div>'+
                        '<div class="tan">'+
                            '<div class="attention">'+
                                '<img src="'+list[s].qr_code+'"/>'+
                                '<span>长按二维码可关注哦</span>'+
                            '</div>'+    
                         '</div>'+
                    '</li>')
                }
                $(".tan").click(function(){
                    $(".tan").hide()
                })
                 $(".join").click(function(){
                    $(".tan").css("background","rgba(0,0,0,0.5)")
                    $(this).siblings(".tan").show();
                })
                $(".code").click(function(){
                    $(".tan").css("background","rgba(0,0,0,0.5)")
                    $(this).siblings(".tan").show();
                 })
            })
            $(".smallNav li").click(function(){
                $(this).addClass("on").siblings().removeClass("on")
            })

            
            $(".smallNav li a").click(function(){
                type_list.html("");
                var  b=$(this).attr("id");
                for(var j=0;j<=list.length-1;j++){
                    if(b==list[j].cate_id){
                        type_list.append('<li>'+
                        '<div class="title">'+list[j].title+'</div>'+
                        '<span>'+
                            '<img src="'+list[j].logo+'" alt="">'+
                        '</span>'+
                        '<a href="javascript:void(0);" class="code">'+
                            '<img src="'+list[j].pic_url+'"/>'+
                        '</a>'+
                        '<div class="join">'+
                            '<span>89人进群</span>'+
                            '<a href="javascript:void(0);">加入</a>'+
                        '</div>'+
                        '<div class="tan">'+
                            '<div class="attention">'+
                                '<img src="'+list[j].qr_code+'"/>'+
                                '<span>长按二维码可关注哦</span>'+
                            '</div>'+    
                         '</div>'+
                    '</li>')
                    }
                }
                $(".tan").click(function(){
                    $(".tan").hide()
                })
                $(".join").click(function(){
                    $(".tan").css("background","rgba(0,0,0,0.5)")
                     $(this).siblings(".tan").show();
                })
                $(".code").click(function(){
                    $(".tan").css("background","rgba(0,0,0,0.5)")
                     $(this).siblings(".tan").show();
                })
            })
             $(".join").click(function(){
                    $(".tan").css("background","rgba(0,0,0,0.5)")
                     $(this).siblings(".tan").show();
             })
            $(".code").click(function(){
                $(".tan").css("background","rgba(0,0,0,0.5)")
                $(this).siblings(".tan").show();
            })
            $(".tan").click(function(){
                $(".tan").hide()
            })
        }
    })


})